#Core microbiome tree
library(phylotools)
install.packages("phylotools")
install.packages("BiocManager")
BiocManager::install("ggtree")
BiocManager::install("Biostrings")
install.packages(c("ape", "ggplot2"))
library(ape)
library(ggtree)
library(utils)
library(ggplot2)
install.packages(c("ape", "phylotools"))
install.packages(c("ape", "phylotools"))
#Core microbiome tree
library(phylotools)
library(ggtree)
library(Biostrings)
library(ape)
setwd("~/Documents/Lichen_Microbiome/Data")
#OTUs fasta file
lichen.fasta<-readDNAStringSet("Â¡Lichen_fasta.fasta", format = "fasta")
#OTUs fasta file
lichen.fasta<-readDNAStringSet("Lichen_fasta.fasta", format = "fasta")
names(lichen.fasta) <- names(lichen.fasta) %>% # Rename  OTUs
strsplit(., split="|",fixed=TRUE) %>%
sapply(.,'[', 2) %>% gsub("\t", "_",.)
#Prepare phyloseq object
OTU = read.table("OTU_table.txt", header=TRUE, sep="\t")
tax = read.table("taxonomy_table.txt", header=TRUE, sep="\t")
row.names(OTU) = OTU$Group
OTU.clean = OTU[,-which(names(OTU) %in% c("label", "numOtus", "Group"))]
row.names(tax) = tax$OTU
tax.clean = tax[row.names(tax) %in% colnames(OTU.clean),]
tax.clean = separate(tax.clean, Taxonomy, into = c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species", "Strain"), sep=";")
tax.clean = tax.clean[,-which(names(tax.clean) %in% c("Size", "Strain", "OTU"))]
OTU.UF = otu_table(as.matrix(OTU.clean), taxa_are_rows=F)
library(tidyr)
tax.clean = separate(tax.clean, Taxonomy, into = c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species", "Strain"), sep=";")
tax.clean = tax[row.names(tax) %in% colnames(OTU.clean),]
tax.clean = separate(tax.clean, Taxonomy, into = c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species", "Strain"), sep=";")
tax.clean = tax.clean[,-which(names(tax.clean) %in% c("Size", "Strain", "OTU"))]
OTU.UF = otu_table(as.matrix(OTU.clean), taxa_are_rows=F)
tax.UF = tax_table(as.matrix(tax.clean))
row.names(OTU) = OTU$Group
OTU.clean = OTU[,-which(names(OTU) %in% c("label", "numOtus", "Group"))]
row.names(tax) = tax$OTU
tax.clean = tax[row.names(tax) %in% colnames(OTU.clean),]
tax.clean = separate(tax.clean, Taxonomy, into = c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species", "Strain"), sep=";")
tax.clean = tax.clean[,-which(names(tax.clean) %in% c("Size", "Strain", "OTU"))]
OTU.UF = otu_table(as.matrix(OTU.clean), taxa_are_rows=F)
### Prevalence Total Lichen Microbiome ###
library(phyloseq)
library(data.table)
install.packages("data.table")
tax.clean = tax[row.names(tax) %in% colnames(OTU.clean),]
tax.clean = separate(tax.clean, Taxonomy, into = c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species", "Strain"), sep=";")
tax.clean = tax.clean[,-which(names(tax.clean) %in% c("Size", "Strain", "OTU"))]
OTU.UF = otu_table(as.matrix(OTU.clean), taxa_are_rows=F)
library(data.table)
### Prevalence Total Lichen Microbiome ###
library(phyloseq)
library(data.table)
BiocManager::install("phyloseq")
### Prevalence Total Lichen Microbiome ###
library(phyloseq)
